Skip to content
Search or jump to…
Pull requests
Issues
Codespaces
Marketplace
Explore
 
@jatin-jangir-0220 
devtron-labs
/
devtron
Public
Fork your own copy of devtron-labs/devtron
Code
Issues
369
Pull requests
88
Actions
Projects
1
Security
Insights
devtron/manifests/yamls/gitsensor.yaml
@dheeth
dheeth fixed initcontainer array
Latest commit 1cbe3cc last week
 History
 10 contributors
@prakarsh-dt@dheeth@pawan-59@pawan-mehta-dt@pghildiyal@deepak-devtron@anupdhiran@jatin-jangir@ladung@jatin-jangir-0220
119 lines (119 sloc)  2.68 KB
 

# Source: gitsensor/templates/generic.yaml
apiVersion: v1
kind: Secret
metadata:
  name: git-sensor-secret
  labels:
    app: git-sensor
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: git-sensor-cm
  labels:
    app: git-sensor
data:
  PG_ADDR: postgresql-postgresql.devtroncd
  PG_USER: postgres
  COMMIT_STATS_TIMEOUT_IN_SEC: "2"
---
# Source: gitsensor/templates/generic.yaml
apiVersion: v1
kind: Service
metadata:
  name: git-sensor-service
  labels:
    app: git-sensor
    release: devtron
spec:
  ports:
    - port: 80
      name: sensor
      targetPort: 8080
  selector:
    app: git-sensor
---
# Source: gitsensor/templates/generic.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: git-sensor
  labels:
    release: devtron
    app: git-sensor
spec:
  selector:
    matchLabels:
      app: git-sensor # has to match .spec.template.metadata.labels
  serviceName: git-sensor
  replicas: 1 # by default is 1
  template:
    metadata:
      labels:
        app: git-sensor
    spec:
      terminationGracePeriodSeconds: 10
      securityContext:
        fsGroup: 1000
        runAsGroup: 1000
        runAsUser: 1000
      initContainers:
        - command:
          - /bin/sh
          - -c
          - chown -R devtron:devtron /git-base
          image: "quay.io/devtron/git-sensor:e5e66474-200-13261"
          imagePullPolicy: IfNotPresent
          name: chown-git-base
          resources: {}
          securityContext:
            runAsUser: 0
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /git-base/
            name: git-volume
      containers:
        - name: git-sensor
          image: "quay.io/devtron/git-sensor:e5e66474-200-13261"
          securityContext:
            allowPrivilegeEscalation: false
            runAsUser: 1000
            runAsNonRoot: true
          ports:
            - containerPort: 8080
              name: sensor
          volumeMounts:
            - name: git-volume
              mountPath: /git-base/
          envFrom:
          - secretRef:
              name: git-sensor-secret
          - configMapRef: 
              name: git-sensor-cm
  volumeClaimTemplates:
    - metadata:
        name: git-volume
      spec:
        accessModes: [ "ReadWriteOnce" ]
        resources:
          requests:
            storage: 2Gi
---
# Source: gitsensor/templates/servicemonitor.yaml
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: git-sensor-sm
  labels:
    chart: gitsensor-0.11.0
    app: git-sensor
    kind: Prometheus
    release: devtron
spec:
  endpoints:
    - port: app
      path: /metrics
  selector:
    matchLabels:
      app: git-sensor
Footer
© 2023 GitHub, Inc.
Footer navigation
Terms
Privacy
Security
Status
Docs
Contact GitHub
Pricing
API
Training
Blog
About
devtron/gitsensor.yaml at v0.6.14 · devtron-labs/devtron
